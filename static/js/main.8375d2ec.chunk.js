(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{28:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var a=n(17),c=(n(26),n(27),n(28),n(3)),r=n.n(c),o=n(11),s=n(5),i=n(15),u=n(2),l=n(4),d=n.n(l),j=n(1),f=n.n(j),p="https://mate.academy/students-api";function b(e){return new Promise((function(t){setTimeout(t,e)}))}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a={method:t};return n&&(a.body=JSON.stringify(n),a.headers={"Content-Type":"application/json; charset=UTF-8"}),b(300).then((function(){return fetch(p+e,a)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var h,O=function(e){return m(e)},v=function(e,t){return m(e,"POST",t)},x=function(e,t){return m(e,"PATCH",t)},g=function(e){return m(e,"DELETE")},y=function(e,t){return x("/todos/".concat(e),t)},N=n(0);!function(e){e.All="all",e.Active="active",e.Completed="completed"}(h||(h={}));var C,k=function(e){var t=e.filter,n=e.todos,a=e.onCompletedClear,c=e.onFilterChange,r=function(e){return d()("filter__link",{selected:t===e})},o=n.filter((function(e){return!e.completed})).length,s=n.some((function(e){return e.completed}));return Object(N.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(N.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(o," items left")}),Object(N.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(N.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:r(h.All),onClick:function(){return c(h.All)},children:"All"}),Object(N.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:r(h.Active),onClick:function(){return c(h.Active)},children:"Active"}),Object(N.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:r(h.Completed),onClick:function(){return c(h.Completed)},children:"Completed"})]}),Object(N.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:"todoapp__clear-completed",onClick:function(){return a()},style:s?{}:{visibility:"hidden"},children:"Clear completed"})]})},S=function(){var e=Object(s.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,a=t.name,e.abrupt("return",v("/users",{email:n,name:a}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e){var t=e.onLogin,n=Object(j.useState)(""),a=Object(u.a)(n,2),c=a[0],o=a[1],i=Object(j.useState)(""),l=Object(u.a)(i,2),f=l[0],p=l[1],b=Object(j.useState)(!1),m=Object(u.a)(b,2),h=m[0],O=m[1],v=Object(j.useState)(!1),x=Object(u.a)(v,2),g=x[0],y=x[1],C=Object(j.useState)(""),k=Object(u.a)(C,2),_=k[0],w=k[1],E=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(j.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(a){w("Failed to log in, Please, try again")}}),[]);var L=function(){var e=Object(s.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(c);case 2:(t=e.sent)?E(t):O(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),w(""),y(!0),e.prev=3,!h){e.next=9;break}return e.next=7,T({name:f,email:c}).then(E);case 7:e.next=11;break;case 9:return e.next=11,L();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),w("Something went wrong");case 16:return e.prev=16,y(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(N.jsxs)("form",{onSubmit:A,className:"box mt-5",children:[Object(N.jsx)("h1",{className:"title is-3",children:h?"You need to register":"Log in to open todos"}),Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(N.jsxs)("div",{className:d()("control has-icons-left",{"is-loading":g}),children:[Object(N.jsx)("input",{type:"email",id:"user-email",className:d()("input",{"is-danger":!h&&_}),placeholder:"Enter your email",disabled:g||h,value:c,required:!0,onChange:function(e){return o(e.target.value)}}),Object(N.jsx)("span",{className:"icon is-small is-left",children:Object(N.jsx)("i",{className:"fas fa-envelope"})})]}),!h&&_&&Object(N.jsx)("p",{className:"help is-danger",children:_})]}),h&&Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(N.jsxs)("div",{className:d()("control has-icons-left",{"is-loading":g}),children:[Object(N.jsx)("input",{type:"text",id:"user-name",className:d()("input",{"is-danger":h&&_}),placeholder:"Enter your name",required:!0,minLength:4,disabled:g,value:f,onChange:function(e){return p(e.target.value)}}),Object(N.jsx)("span",{className:"icon is-small is-left",children:Object(N.jsx)("i",{className:"fas fa-user"})})]}),h&&_&&Object(N.jsx)("p",{className:"help is-danger",children:_})]}),Object(N.jsx)("div",{className:"field",children:Object(N.jsx)("button",{type:"submit",className:d()("button is-primary",{"is-loading":g}),children:h?"Register":"Login"})})]})},w=f.a.createContext(null),E=function(e){var t=e.children,n=Object(j.useState)(null),a=Object(u.a)(n,2),c=a[0],r=a[1];return c?Object(N.jsx)(w.Provider,{value:c,children:t}):Object(N.jsx)(_,{onLogin:r})},L=function(e){var t=e.input,n=e.isAdding,a=e.todoOnload,c=e.onInputChange,r=e.onSubmit,o=Object(j.useRef)(null);return Object(j.useEffect)((function(){o.current&&o.current.focus()}),[a]),Object(N.jsx)("form",{onSubmit:r,children:Object(N.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:o,className:"todoapp__new-todo",placeholder:"What needs to be done?",onChange:c,value:t,disabled:n})})},A=n(36),I=n(35),F=function(e){var t=e.todo,n=e.todoIdsOnLoad,a=e.onTodoDelete,c=e.onTodoComplete,r=e.saveInputChange,o=t.completed,s=t.title,i=t.id,l=Object(j.useState)(!1),f=Object(u.a)(l,2),p=f[0],b=f[1],m=Object(j.useState)(s),h=Object(u.a)(m,2),O=h[0],v=h[1],x=function(){O!==s?(r(i,O),b(!1)):b(!1)};return Object(N.jsxs)("div",{"data-cy":"Todo",className:d()("todo",{completed:o}),children:[Object(N.jsx)("label",{className:"todo__status-label",children:Object(N.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",onChange:function(){return c(t)}})}),p?Object(N.jsx)("input",{autoFocus:!0,type:"text",className:"todo__title-field",value:O,onChange:function(e){v(e.currentTarget.value)},onBlur:function(){x()},onKeyDown:function(e){"Escape"!==e.key?"Enter"===e.key&&x():b(!1)}}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){return b(!0)},children:s}),Object(N.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){return a(i)},children:"\xd7"})]}),Object(N.jsxs)("div",{"data-cy":"TodoLoader",className:d()("modal overlay",{"is-active":n.includes(i)||0===t.id}),children:[Object(N.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(N.jsx)("div",{className:"loader"})]})]})},D=function(e){var t=e.todos,n=e.filter,a=e.todoOnLoad,c=e.todoIdsOnLoad,r=e.onTodoDelete,o=e.onTodoComplete,s=e.saveInputChange;return Object(N.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:Object(N.jsxs)(A.a,{children:[t.filter((function(e){switch(n){case"active":return!e.completed;case"completed":return e.completed;default:return e}})).map((function(e){return Object(N.jsx)(I.a,{timeout:300,classNames:"item",children:Object(N.jsx)(F,{todo:e,todoIdsOnLoad:c,onTodoDelete:r,onTodoComplete:o,saveInputChange:s},e.id)},e.id)})),a&&Object(N.jsx)(I.a,{timeout:300,classNames:"temp-item",children:Object(N.jsx)(F,{todo:a,todoIdsOnLoad:c,onTodoDelete:r,onTodoComplete:o,saveInputChange:s})},0)]})})};!function(e){e.Server="Unable to load data from the Server",e.Post="Unable to add the Todo",e.Add="Title can't be empty",e.Delete="Unable to delete a todo",e.Update="Unable to update a todo"}(C||(C={}));var P=function(){var e=Object(j.useContext)(w),t=Object(j.useState)([]),n=Object(u.a)(t,2),a=n[0],c=n[1],l=Object(j.useState)(h.All),f=Object(u.a)(l,2),p=f[0],b=f[1],m=Object(j.useState)(""),x=Object(u.a)(m,2),S=x[0],T=x[1],_=Object(j.useState)(""),E=Object(u.a)(_,2),A=E[0],I=E[1],F=Object(j.useState)(!1),P=Object(u.a)(F,2),U=P[0],B=P[1],J=Object(j.useState)(null),R=Object(u.a)(J,2),q=R[0],H=R[1],Y=Object(j.useState)([]),G=Object(u.a)(Y,2),K=G[0],W=G[1],z=Object(j.useState)(!1),M=Object(u.a)(z,2),Q=M[0],V=M[1],X=function(e){W([].concat(Object(i.a)(K),[e]))},Z=function(e){var t=e.map((function(e){return e.id}));W(t)},$=function(){var t;e&&(t=e.id,O("/todos?userId=".concat(t))).then((function(e){return c(e)})).catch((function(){return T(C.Server)})).finally((function(){return W([])}))},ee=function(e){var t;(t=e,g("/todos/".concat(t))).then((function(){return $()})).catch((function(){return T(C.Delete)}))},te=function(){var e=Object(s.a)(r.a.mark((function e(t,n){var a,s=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>2&&void 0!==s[2]&&s[2],X(t),e.prev=2,e.next=5,y(t,n);case 5:c((function(e){return e.map((function(e){return a||e.id===t?Object(o.a)(Object(o.a)({},e),n):e}))})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),T(C.Update);case 11:return e.prev=11,W((function(e){return e.filter((function(e){return e!==t}))})),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[2,8,11,14]])})));return function(t,n){return e.apply(this,arguments)}}(),ne=function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:te(t.id,{completed:!t.completed});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var t=Object(s.a)(r.a.mark((function t(n){var o,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),A){t.next=5;break}return T(C.Add),setTimeout((function(){return T("")}),3e3),t.abrupt("return");case 5:if(!e){t.next=24;break}return o={id:0,userId:e.id,title:A,completed:!1},B(!0),t.prev=8,H(o),t.next=12,v("/todos",o);case 12:s=t.sent,c([].concat(Object(i.a)(a),[s])),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(8),T(C.Post);case 19:return t.prev=19,I(""),B(!1),H(null),t.finish(19);case 24:case"end":return t.stop()}}),t,null,[[8,16,19,24]])})));return function(e){return t.apply(this,arguments)}}();return Object(j.useEffect)((function(){return $()}),[]),Object(j.useEffect)((function(){var e=a.every((function(e){return e.completed}));V(!!e)}),[a]),Object(N.jsxs)("div",{className:"todoapp",children:[Object(N.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(N.jsxs)("div",{className:"todoapp__content",children:[Object(N.jsxs)("header",{className:"todoapp__header",children:[!!a.length&&Object(N.jsx)("button",{"data-cy":"ToggleAllButton",type:"button",className:d()("todoapp__toggle-all",{active:Q}),onClick:function(){return V(!Q),a.forEach((function(e){return te(e.id,{completed:!Q},!0)})),void Z(a)}}),Object(N.jsx)(L,{input:A,isAdding:U,todoOnload:q,onInputChange:function(e){I(e.currentTarget.value),T("")},onSubmit:ae})]}),!!a.length&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(D,{todos:a,filter:p,todoOnLoad:q,todoIdsOnLoad:K,onTodoDelete:function(e){ee(e),X(e)},onTodoComplete:ne,saveInputChange:function(e,t){if(!t)return X(e),void ee(e);te(e,{title:t})}}),Object(N.jsx)(k,{filter:p,todos:a,onFilterChange:function(e){return b(e)},onCompletedClear:function(){var e=a.filter((function(e){return e.completed}));Z(e),e.map((function(e){return ee(e.id)}))}})]})]}),Object(N.jsxs)("div",{"data-cy":"ErrorNotification",className:d()("notification is-danger is-light has-text-weight-normal",{hidden:!S}),children:[Object(N.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete",onClick:function(){return T("")}}),S]})]})},U=function(){return Object(N.jsx)(E,{children:Object(N.jsx)(P,{})})};Object(a.createRoot)(document.getElementById("root")).render(Object(N.jsx)(U,{}))}},[[33,1,2]]]);
//# sourceMappingURL=main.8375d2ec.chunk.js.map